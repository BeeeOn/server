<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>BeeeOn Server: User access policy</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="BeeeOn.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">BeeeOn Server
   &#160;<span id="projectnumber">v2018.11.1</span>
   </div>
   <div id="projectbrief">Platform to interconnect the IoT world</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',false,false,'search.php','Search');
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">User access policy </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Each user frontend maintains a user session in some way. The session identifies a user which grants her a set of permission rules. The permissions are based on the selected <em>access policy</em>. Usually, for each significant entity, relation or function in the system, there is a separate policy interface:</p>
<ul>
<li><code>GatewayAccessPolicy</code></li>
<li><code>DeviceAccessPolicy</code></li>
<li><code>RoleAccessPolicy</code></li>
<li><code>SensorAccessPolicy</code></li>
<li><code>SensorHistoryAccessPolicy</code></li>
<li><code>ControlAccessPolicy</code></li>
<li><code>IdentityAccessPolicy</code></li>
<li><code>LocationAccessPolicy</code></li>
<li><code>FCMTokenAccessPolicy</code></li>
<li>etc.</li>
</ul>
<p>There is currently only one implementation of them: <code>DefaultAccessPolicy</code>. The class <code>DefaultAccessPolicy</code> contains a hard-wired strategy to grant permissions to perform certain tasks as defined by the implemented interfaces.</p>
<h2>Access level</h2>
<p>BeeeOn Server defines a term <em>access level</em>. An access level is basically an unsigned number where <em>0</em> denotes the <b>highest permission level</b> (<em>root</em>). In practice, the system works with more coarse grain access levels. There are 5 levels:</p>
<ul>
<li><em>ANY</em> (0) - useful to define rules (not user levels)</li>
<li><em>ADMIN</em> (10) - the highest permission level available to be widely used</li>
<li><em>USER</em> (20) - user that can do regular operations with devices</li>
<li><em>GUEST</em> (30) - guest with read-only access</li>
<li><em>NONE</em> (100) - no access, the lowest defined level to be practically used</li>
</ul>
<h2>Gateway registration</h2>
<p>Each BeeeOn Gateway is registered by its unique ID. The gateway, when connected for the first time, registers itself with the BeeeOn Server. The user who knows that ID can register with the gateway and become its maintainer. Such user is automatically granted the access level <em>ADMIN</em>. Nobody else can now register the gateway.</p>
<h2>Overview of default access policy</h2>
<p>The following table summarizes how the <code>DefaultAccessPolicy</code> class handles access policy to each entity.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter">Entity  </th><th class="markdownTableHeadCenter">Action  </th><th class="markdownTableHeadCenter"><em>ADMIN</em>  </th><th class="markdownTableHeadCenter"><em>USER</em>  </th><th class="markdownTableHeadCenter"><em>GUEST</em>   </th></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyCenter"><code>Control</code>  </td><td class="markdownTableBodyCenter"><code>GET</code>  </td><td class="markdownTableBodyCenter">y  </td><td class="markdownTableBodyCenter">y  </td><td class="markdownTableBodyCenter">y   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyCenter"><code>Control</code>  </td><td class="markdownTableBodyCenter"><code>SET</code>  </td><td class="markdownTableBodyCenter">y  </td><td class="markdownTableBodyCenter">y  </td><td class="markdownTableBodyCenter">n   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyCenter"><code>Device</code>  </td><td class="markdownTableBodyCenter"><code>GET</code>  </td><td class="markdownTableBodyCenter">y  </td><td class="markdownTableBodyCenter">y  </td><td class="markdownTableBodyCenter">y   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyCenter"><code>Device</code>  </td><td class="markdownTableBodyCenter"><code>UNREGISTER</code>  </td><td class="markdownTableBodyCenter">y  </td><td class="markdownTableBodyCenter">n  </td><td class="markdownTableBodyCenter">n   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyCenter"><code>Device</code>  </td><td class="markdownTableBodyCenter"><code>ACTIVATE</code>  </td><td class="markdownTableBodyCenter">y  </td><td class="markdownTableBodyCenter">n  </td><td class="markdownTableBodyCenter">n   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyCenter"><code>Device</code>  </td><td class="markdownTableBodyCenter"><code>UPDATE</code>  </td><td class="markdownTableBodyCenter">y  </td><td class="markdownTableBodyCenter">y  </td><td class="markdownTableBodyCenter">n   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyCenter"><code>Device</code>  </td><td class="markdownTableBodyCenter"><code>UPDATE_AND_ACTIVATE</code>  </td><td class="markdownTableBodyCenter">y  </td><td class="markdownTableBodyCenter">n  </td><td class="markdownTableBodyCenter">n   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyCenter"><code>FCMToken</code>  </td><td class="markdownTableBodyCenter"><code>REGISTER</code>  </td><td class="markdownTableBodyCenter">y  </td><td class="markdownTableBodyCenter">y  </td><td class="markdownTableBodyCenter">y   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyCenter"><code>FCMToken</code>  </td><td class="markdownTableBodyCenter"><code>UNREGISTER</code>  </td><td class="markdownTableBodyCenter">y  </td><td class="markdownTableBodyCenter">y  </td><td class="markdownTableBodyCenter">y   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyCenter"><code>Gateway</code>  </td><td class="markdownTableBodyCenter"><code>REGISTER</code>  </td><td class="markdownTableBodyCenter">y<sup>1</sup>  </td><td class="markdownTableBodyCenter">y<sup>1</sup>  </td><td class="markdownTableBodyCenter">y<sup>1</sup>   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyCenter"><code>Gateway</code>  </td><td class="markdownTableBodyCenter"><code>UNREGISTER</code>  </td><td class="markdownTableBodyCenter">y<sup>4</sup>  </td><td class="markdownTableBodyCenter">y<sup>4</sup>  </td><td class="markdownTableBodyCenter">y<sup>4</sup>   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyCenter"><code>Gateway</code>  </td><td class="markdownTableBodyCenter"><code>GET</code>  </td><td class="markdownTableBodyCenter">y  </td><td class="markdownTableBodyCenter">y  </td><td class="markdownTableBodyCenter">y   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyCenter"><code>Gateway</code>  </td><td class="markdownTableBodyCenter"><code>UPDATE</code>  </td><td class="markdownTableBodyCenter">y  </td><td class="markdownTableBodyCenter">y  </td><td class="markdownTableBodyCenter">n   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyCenter"><code>Gateway</code>  </td><td class="markdownTableBodyCenter"><code>SCAN</code>  </td><td class="markdownTableBodyCenter">y  </td><td class="markdownTableBodyCenter">y  </td><td class="markdownTableBodyCenter">n   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyCenter"><code>GatewayMessage</code>  </td><td class="markdownTableBodyCenter"><code>GET</code>  </td><td class="markdownTableBodyCenter">y  </td><td class="markdownTableBodyCenter">y  </td><td class="markdownTableBodyCenter">n   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyCenter"><code>GatewayMessage</code>  </td><td class="markdownTableBodyCenter"><code>REMOVE</code>  </td><td class="markdownTableBodyCenter">y  </td><td class="markdownTableBodyCenter">n  </td><td class="markdownTableBodyCenter">n   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyCenter"><code>Identity</code>  </td><td class="markdownTableBodyCenter"><code>GET</code>  </td><td class="markdownTableBodyCenter">y<sup>2</sup>  </td><td class="markdownTableBodyCenter">y<sup>2</sup>  </td><td class="markdownTableBodyCenter">y<sup>2</sup>   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyCenter"><code>Location</code>  </td><td class="markdownTableBodyCenter"><code>GET</code>  </td><td class="markdownTableBodyCenter">y  </td><td class="markdownTableBodyCenter">y  </td><td class="markdownTableBodyCenter">y   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyCenter"><code>Location</code>  </td><td class="markdownTableBodyCenter"><code>CREATE</code>  </td><td class="markdownTableBodyCenter">y  </td><td class="markdownTableBodyCenter">y  </td><td class="markdownTableBodyCenter">n   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyCenter"><code>Location</code>  </td><td class="markdownTableBodyCenter"><code>UPDATE</code>  </td><td class="markdownTableBodyCenter">y  </td><td class="markdownTableBodyCenter">y  </td><td class="markdownTableBodyCenter">n   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyCenter"><code>Location</code>  </td><td class="markdownTableBodyCenter"><code>REMOVE</code>  </td><td class="markdownTableBodyCenter">y  </td><td class="markdownTableBodyCenter">y  </td><td class="markdownTableBodyCenter">n   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyCenter"><code>RoleInGateway</code>  </td><td class="markdownTableBodyCenter"><code>INVITE</code>  </td><td class="markdownTableBodyCenter">y  </td><td class="markdownTableBodyCenter">n  </td><td class="markdownTableBodyCenter">n   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyCenter"><code>RoleInGateway</code>  </td><td class="markdownTableBodyCenter"><code>GET</code>  </td><td class="markdownTableBodyCenter">y  </td><td class="markdownTableBodyCenter">y  </td><td class="markdownTableBodyCenter">y   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyCenter"><code>RoleInGateway</code>  </td><td class="markdownTableBodyCenter"><code>UPDATE</code>  </td><td class="markdownTableBodyCenter">y<sup>3</sup>  </td><td class="markdownTableBodyCenter">n  </td><td class="markdownTableBodyCenter">n   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyCenter"><code>RoleInGateway</code>  </td><td class="markdownTableBodyCenter"><code>REMOVE</code>  </td><td class="markdownTableBodyCenter">y<sup>4</sup>  </td><td class="markdownTableBodyCenter">n  </td><td class="markdownTableBodyCenter">n   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowEven">
<td class="markdownTableBodyCenter"><code>Sensor</code>  </td><td class="markdownTableBodyCenter"><code>GET</code>  </td><td class="markdownTableBodyCenter">y  </td><td class="markdownTableBodyCenter">y  </td><td class="markdownTableBodyCenter">y   </td></tr>
<tr class="markdownTableBody" class="markdownTableRowOdd">
<td class="markdownTableBodyCenter"><code>SensorHistory</code>  </td><td class="markdownTableBodyCenter"><code>GET</code>  </td><td class="markdownTableBodyCenter">y  </td><td class="markdownTableBodyCenter">y  </td><td class="markdownTableBodyCenter">y   </td></tr>
</table>
<p><em>Notes:</em></p>
<p><sup>1</sup> Anybody can register a new gateway that has no <em>ADMIN</em> at that time. If a gateway has already a user (i.e. at least one <em>ADMIN</em>), such gateway cannot be registered this way. The user needs to be invited to use that gateway. This is not defined by the access policy. This is defined by the application logic.</p>
<p><sup>2</sup> Getting information about an identity depends on the dynamic state of the system and not on the access level. It is possible to see all identities involved in the gateway where the user involved as well.</p>
<p><sup>3</sup> <em>ADMIN</em> cannot change her own access level (e.g. make herself a <em>USER</em>).</p>
<p><sup>4</sup> No user can remove her own role via <code>RoleInGateway::REMOVE</code>. However, this is not defined by any access policy. This is defined by the application logic. If there are no more <em>ADMIN</em> roles associated with a gateway, it is possible to unregister that gateway from all users at once by removing the gateway (<code>Gateway::UNREGISTER</code>). If there are some other admins, any user can remove the gateway (<code>Gateway::UNREGISTER</code>) which in turn removes her role.</p>
<h2>Gateway owner</h2>
<p>Originally, the BeeeOn Server was using the term <em>gateway owner</em>. The current version of the BeeeOn Server does not have any kind of such role. For backwards compatibility, the owner of the gateway is the user with <em>ADMIN</em> access level who has first registered with the gateway. Usually, the user who registers a gateway for the first time is the owner. If there are more <em>ADMIN</em> users invited and the original owner is removed, the second oldest user with <em>ADMIN</em> access level is treated as the owner. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
