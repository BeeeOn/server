<system>
	<factory>
		<alias name="sessionManager" ref="${session.manager}SessionManager" />

		<instance name="systemSessionManager" class="BeeeOn::SessionManagerImpl">
			<set name="secureRandomProvider"
				ref="pocoRandomProvider" />
			<set name="sessionExpireTime" time="${session.expire}" />
			<set name="maxUserSessions" number="${session.maxPerUser}" />
		</instance>

		<instance name="jwtDecoder" class="BeeeOn::JWTDecoder">
			<set name="secret" text="${session.jwt.secret}" />
		</instance>

		<instance name="jwtEncoder" class="BeeeOn::JWTEncoder">
			<set name="secret" text="${session.jwt.secret}" />
			<set name="algorithm" text="${session.jwt.algorithm}" />
		</instance>

		<instance name="jwtSessionManager" class="BeeeOn::JWTSessionManager">
			<set name="audienceList" list="${session.jwt.audience}" />
			<set name="jwtDecoder" ref="jwtDecoder" />
			<set name="jwtEncoder" ref="jwtEncoder" />
			<set name="localeManager" ref="localeManager" />
			<set name="issuerName" text="BeeeOn" />
			<set name="sessionExpireTime" time="${session.expire}" />
		</instance>

		<instance name="googlePermitAuthProvider"
				class="BeeeOn::PermitAuthProvider">
			<set name="resultProvider" text="google" />
		</instance>

		<instance name="googleAuthProvider"
				class="BeeeOn::GoogleAuthProvider">
			<set name="clientSecret" text="${google.clientSecret}"/>
			<set name="clientId" text="${google.clientId}"/>
			<set name="redirectUri" text="${google.redirectUri}"/>
			<set name="sslConfig" ref="googleOAuthSSL"/>
		</instance>

		<instance name="facebookAuthProvider"
				class="BeeeOn::FacebookAuthProvider">
			<set name="clientSecret" text="${facebook.clientSecret}"/>
			<set name="clientId" text="${facebook.clientId}"/>
			<set name="redirectUri" text="${facebook.redirectUri}"/>
			<set name="sslConfig" ref="facebookOAuthSSL"/>
		</instance>
	</factory>
</system>
