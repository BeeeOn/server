<system>
	<factory>
		<instance name="ui" class="BeeeOn::LoopRunner">
			<add name="loops" ref="uiServer" />
		</instance>

		<instance name="uiServer" class="BeeeOn::PocoRestServer">
			<set name="router" ref="uiRouter" />
			<set name="sessionVerifier" ref="sessionVerifier" />
			<set name="port" number="${restui.port}" />
		</instance>

		<instance name="sessionVerifier" class="BeeeOn::SessionVerifier">
			<set name="sessionManager" ref="sessionManager" />
		</instance>

		<instance name="uiRouter" class="BeeeOn::RestRouter">
			<set name="apiName" text="restui" />
			<set name="applicationName" text="BeeeOn Server" />
			<set name="configurationFile" text="${spec.restui.ini}" />
			<add name="handlers" ref="uiAuthHandler" />
			<add name="handlers" ref="uiBuiltinHandler" />
			<add name="handlers" ref="uiGatewayHandler" />
			<add name="handlers" ref="uiProfileHandler" />
			<add name="handlers" ref="uiLocationHandler" />
		</instance>

		<instance name="uiBuiltinHandler" class="BeeeOn::BuiltinRestHandler" />

		<instance name="uiAuthHandler" class="BeeeOn::AuthRestHandler">
			<set name="authService" ref="authService" />
		</instance>

		<instance name="uiGatewayHandler" class="BeeeOn::RestUI::GatewayRestHandler">
			<set name="gatewayService" ref="gatewayService" />
		</instance>

		<instance name="uiProfileHandler" class="BeeeOn::RestUI::ProfileRestHandler">
			<set name="identityService" ref="identityService" />
		</instance>

		<instance name="uiLocationHandler" class="BeeeOn::RestUI::LocationRestHandler">
			<set name="locationService" ref="locationService" />
		</instance>
	</factory>
</system>
