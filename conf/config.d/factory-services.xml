<system>
	<factory>
		<!-- Bussiness layer -->

		<instance name="userService" class="BeeeOn::UserServiceImpl">
			<set name="userDao" ref="userDao" />
			<set name="transactionManager" ref="transactionManager" />
		</instance>

		<instance name="authService" class="BeeeOn::AuthServiceImpl">
			<set name="userDao" ref="userDao" />
			<set name="identityDao" ref="identityDao" />
			<set name="verifiedIdentityDao" ref="verifiedIdentityDao" />
			<set name="sessionManager" ref="sessionManager" />
			<set name="notificationDispatcher" ref="notificationDispatcher" />
			<set name="transactionManager" ref="transactionManager" />
			<set name="localeManager" ref="localeManager" />
			<add name="providers" ref="googlePermitAuthProvider" if-yes="${testing.enable}" />
			<add name="providers" ref="googleWebAuth" if-yes="${web-app.google.enable}" />
			<add name="providers" ref="googleAndroidAuth" if-yes="${android.google.enable}" />
			<add name="providers" ref="facebookWebAuth" if-yes="${web-app.facebook.enable}" />
			<add name="providers" ref="facebookAndroidAuth" if-yes="${android.facebook.enable}" />
			<add name="providers" ref="googleTesterAuth" if-yes="${tester.google.enable}" />
		</instance>

		<instance name="deviceService" class="BeeeOn::DeviceServiceImpl">
			<set name="deviceDao" ref="deviceDao" />
			<set name="controlDao" ref="controlDao" />
			<set name="sensorHistoryDao" ref="sensorHistoryDao" />
			<set name="devicePropertyDao" ref="devicePropertyDao" />
			<set name="gatewayRPC" ref="gatewayRPC" />
			<set name="accessPolicy" ref="accessPolicy" />
			<set name="transactionManager" ref="transactionManager" />
		</instance>

		<instance name="gwsDeviceService" class="BeeeOn::GWSDeviceServiceImpl">
			<set name="deviceDao" ref="deviceDao" />
			<set name="deviceInfoProvider" ref="deviceInfoProvider" />
			<set name="transactionManager" ref="transactionManager" />
		</instance>

		<instance name="gatewayService" class="BeeeOn::GatewayServiceImpl">
			<set name="gatewayDao" ref="gatewayDao" />
			<set name="roleInGatewayDao" ref="roleInGatewayDao" />
			<set name="identityDao" ref="identityDao" />
			<set name="verifiedIdentityDao" ref="verifiedIdentityDao" />
			<set name="gatewayRPC" ref="gatewayRPC" />
			<set name="accessPolicy" ref="accessPolicy" />
			<set name="transactionManager" ref="transactionManager" />
			<set name="scanController" ref="gatewayScanController" />
		</instance>

		<instance name="gwsGatewayService" class="BeeeOn::GWSGatewayServiceImpl">
			<set name="gatewayDao" ref="gatewayDao" />
			<set name="gatewayStatusDao" ref="gatewayStatusDao" />
			<set name="transactionManager" ref="transactionManager" />
		</instance>

		<instance name="locationService"
				class="BeeeOn::LocationServiceImpl">
			<set name="locationDao" ref="locationDao" />
			<set name="gatewayDao" ref="gatewayDao" />
			<set name="accessPolicy" ref="accessPolicy" />
			<set name="transactionManager" ref="transactionManager" />
		</instance>

		<instance name="identityService" class="BeeeOn::IdentityServiceImpl">
			<set name="identityDao" ref="identityDao" />
			<set name="verifiedIdentityDao" ref="verifiedIdentityDao" />
			<set name="accessPolicy" ref="accessPolicy" />
			<set name="transactionManager" ref="transactionManager" />
		</instance>

		<instance name="roleService" class="BeeeOn::RoleServiceImpl">
			<set name="identityDao" ref="identityDao" />
			<set name="verifiedIdentityDao" ref="verifiedIdentityDao" />
			<set name="gatewayDao" ref="gatewayDao" />
			<set name="roleInGatewayDao" ref="roleInGatewayDao" />
			<set name="accessPolicy" ref="accessPolicy" />
			<set name="transactionManager" ref="transactionManager" />
			<set name="notificationDispatcher" ref="notificationDispatcher" />
		</instance>

		<instance name="sensorService" class="BeeeOn::SensorServiceImpl">
			<set name="sensorHistoryDao" ref="sensorHistoryDao" />
			<set name="deviceDao" ref="deviceDao" />
			<set name="transactionManager" ref="transactionManager" />
			<set name="accessPolicy" ref="accessPolicy" />
		</instance>

		<instance name="controlService" class="BeeeOn::ControlServiceImpl">
			<set name="deviceDao" ref="deviceDao" />
			<set name="controlDao" ref="controlDao" />
			<set name="transactionManager" ref="transactionManager" />
			<set name="accessPolicy" ref="accessPolicy" />
		</instance>

		<instance name="sensorHistoryService" class="BeeeOn::SensorHistoryServiceImpl">
			<set name="sensorHistoryDao" ref="sensorHistoryDao" />
			<set name="deviceDao" ref="deviceDao" />
			<set name="transactionManager" ref="transactionManager" />
			<set name="accessPolicy" ref="accessPolicy" />
		</instance>

		<instance name="fcmTokenService" class="BeeeOn::FCMTokenServiceImpl">
			<set name="fcmTokenDao" ref="fcmTokenDao" />
			<set name="transactionManager" ref="transactionManager" />
			<set name="accessPolicy" ref="accessPolicy" />
		</instance>

		<instance name="gwsSensorHistoryService"
				class="BeeeOn::GWSSensorHistoryServiceImpl">
			<set name="sensorHistoryDao" ref="sensorHistoryDao" />
			<set name="deviceDao" ref="deviceDao" />
			<set name="transactionManager" ref="transactionManager" />
		</instance>

		<!-- Access policy -->

		<instance name="accessPolicy"
				class="BeeeOn::DefaultAccessPolicy">
			<set name="userDao" ref="userDao" />
			<set name="gatewayDao" ref="gatewayDao" />
			<set name="locationDao" ref="locationDao" />
			<set name="deviceDao" ref="deviceDao" />
			<set name="roleInGatewayDao" ref="sqlRoleInGatewayDao" />
			<set name="fcmTokenDao" ref="fcmTokenDao" />
		</instance>

	</factory>
</system>
